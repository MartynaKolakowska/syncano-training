{"version":3,"sources":["../../../src/utils/registry/registry.js"],"names":["debug","Registry","searchSocketByName","name","version","session","connection","registry","getSocket","socket","fileName","path","join","getBuildPath","fileDescriptor","fs","createWriteStream","url","publishSocket","socketName","searchSocketsByAll","keyword","submitSocket","createPackageZip","spec","getFullConfig","getSocketZip"],"mappings":";;;;;;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;AAEA,MAAM,EAAEA,KAAF,KAAY,qBAAO,gBAAP,CAAlB;;AAEA,MAAMC,QAAN,CAAe;AACPC,oBAAN,CAA0BC,IAA1B,EAAgCC,OAAhC,EAAyC;AAAA;AACvCJ,YAAO,uBAAsBG,IAAK,IAAGC,OAAQ,EAA7C;AACA,aAAOC,kBAAQC,UAAR,CAAmBC,QAAnB,CAA4BL,kBAA5B,CAA+CC,IAA/C,EAAqDC,OAArD,CAAP;AAFuC;AAGxC;;AAED,SAAOI,SAAP,CAAkBC,MAAlB,EAA0B;AACxBT,UAAM,WAAN;;AAEA,UAAMU,WAAWC,eAAKC,IAAL,CAAUP,kBAAQQ,YAAR,EAAV,EAAmC,GAAEJ,OAAON,IAAK,MAAjD,CAAjB;AACA,UAAMW,iBAAiBC,aAAGC,iBAAH,CAAqBN,QAArB,CAAvB;;AAEA,WAAOL,kBAAQC,UAAR,CAAmBC,QAAnB,CAA4BC,SAA5B,CAAsCC,OAAOQ,GAA7C,EAAkDH,cAAlD,CAAP;AACD;;AAEKI,eAAN,CAAqBC,UAArB,EAAiCf,OAAjC,EAA0C;AAAA;AACxCJ,YAAO,kBAAiBmB,UAAW,KAAIf,OAAQ,EAA/C;AACA,aAAOC,kBAAQC,UAAR,CAAmBC,QAAnB,CAA4BW,aAA5B,CAA0CC,UAA1C,EAAsDf,OAAtD,CAAP;AAFwC;AAGzC;;AAEKgB,oBAAN,CAA0BC,OAA1B,EAAmC;AAAA;AACjCrB,YAAO,uBAAsBqB,OAAQ,EAArC;AACA,aAAOhB,kBAAQC,UAAR,CAAmBC,QAAnB,CAA4Ba,kBAA5B,CAA+CC,OAA/C,CAAP;AAFiC;AAGlC;;AAEKC,cAAN,CAAoBb,MAApB,EAA4B;AAAA;AAC1BT,YAAO,iBAAgBS,OAAON,IAAK,EAAnC;AACA,YAAMM,OAAOc,gBAAP,EAAN;;AAEA,aAAOlB,kBACJC,UADI,CAEJC,QAFI,CAGJe,YAHI,CAGSb,OAAOe,IAHhB,EAGsBf,OAAOgB,aAAP,EAHtB,EAG8ChB,OAAOiB,YAAP,EAH9C,CAAP;AAJ0B;AAQ3B;AAjCY;;kBAoCAzB,Q","file":"registry.js","sourcesContent":["import fs from 'fs'\nimport path from 'path'\n\nimport logger from '../debug'\nimport session from '../session'\n\nconst { debug } = logger('utils-registry')\n\nclass Registry {\n  async searchSocketByName (name, version) {\n    debug(`searchSocketByName: ${name} ${version}`)\n    return session.connection.registry.searchSocketByName(name, version)\n  }\n\n  static getSocket (socket) {\n    debug('getSocket')\n\n    const fileName = path.join(session.getBuildPath(), `${socket.name}.zip`)\n    const fileDescriptor = fs.createWriteStream(fileName)\n\n    return session.connection.registry.getSocket(socket.url, fileDescriptor)\n  }\n\n  async publishSocket (socketName, version) {\n    debug(`publishSocket: ${socketName}, ${version}`)\n    return session.connection.registry.publishSocket(socketName, version)\n  }\n\n  async searchSocketsByAll (keyword) {\n    debug(`searchSocketsByAll: ${keyword}`)\n    return session.connection.registry.searchSocketsByAll(keyword)\n  }\n\n  async submitSocket (socket) {\n    debug(`submitSocket: ${socket.name}`)\n    await socket.createPackageZip()\n\n    return session\n      .connection\n      .registry\n      .submitSocket(socket.spec, socket.getFullConfig(), socket.getSocketZip())\n  }\n}\n\nexport default Registry\n"]}