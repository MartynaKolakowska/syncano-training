{"version":3,"sources":["../../src/utils/templates.js"],"names":["debug","getTemplatePath","templateName","options","paths","path","join","process","cwd","dirname","require","resolve","getTemplateSpec","templatePath","JSON","parse","fs","readFileSync","getTemplate","builtInSocketTemplates","builtInProjectTemplates","findInstalledTemplates","pattern","configFile","regex","RegExp","devDeps","_","findKey","devDependencies","obj","key","match","deps","dependencies","concat","err","installedProjectTemplates","installedSocketTemplates"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,MAAM,EAAEA,KAAF,KAAY,qBAAO,UAAP,CAAlB;;AAEA,MAAMC,kBAAmBC,YAAD,IAAkB;AACxCF,QAAM,iBAAN,EAAyBE,YAAzB;AACA,QAAMC,UAAU,EAAEC,OAAO,CAACC,eAAKC,IAAL,CAAUC,QAAQC,GAAR,EAAV,EAAyB,cAAzB,CAAD,CAAT,EAAhB;AACA,SAAOH,eAAKI,OAAL,CAAaC,QAAQC,OAAR,CAAgBT,YAAhB,EAA8BC,OAA9B,CAAb,CAAP;AACD,CAJD;;AAMA,MAAMS,kBAAmBV,YAAD,IAAkB;AACxC,QAAMW,eAAeZ,gBAAgBC,YAAhB,CAArB;AACAF,QAAM,iBAAN,EAAyBa,YAAzB;AACA,SAAOC,KAAKC,KAAL,CACLC,aAAGC,YAAH,CAAgBZ,eAAKC,IAAL,CAAUO,YAAV,EAAwB,cAAxB,CAAhB,CADK,CAAP;AAGD,CAND;;AAQA,SAASK,WAAT,CAAsBhB,YAAtB,EAAoC;AAClCF,QAAM,aAAN,EAAqBE,YAArB;AACA,QAAMW,eAAeZ,gBAAgBC,YAAhB,CAArB;AACA,SAAOG,eAAKC,IAAL,CAAUO,YAAV,EAAwB,UAAxB,CAAP;AACD;;AAED,MAAMM,yBAAyB,CAC7B,kCAD6B,EAE7B,8BAF6B,EAG7B,uCAH6B,CAA/B;;AAMA,MAAMC,0BAA0B,CAC9B,iCAD8B,EAE9B,iCAF8B,CAAhC;;AAKA,MAAMC,yBAA0BC,OAAD,IAAa;AAC1CtB,QAAM,wBAAN,EAAgCsB,OAAhC;AACA,MAAI;AACF,UAAMC,aAAaT,KAAKC,KAAL,CAAWC,aAAGC,YAAH,CAAgBZ,eAAKC,IAAL,CAAUC,QAAQC,GAAR,EAAV,EAAyB,cAAzB,CAAhB,CAAX,CAAnB;AACA,UAAMgB,QAAQ,IAAIC,MAAJ,CAAWH,OAAX,CAAd;AACA,UAAMI,UAAUC,iBAAEC,OAAF,CAAUL,WAAWM,eAArB,EAAsC,CAACC,GAAD,EAAMC,GAAN,KAAcA,IAAIC,KAAJ,CAAUR,KAAV,CAApD,CAAhB;AACA,UAAMS,OAAON,iBAAEC,OAAF,CAAUL,WAAWW,YAArB,EAAmC,CAACJ,GAAD,EAAMC,GAAN,KAAcA,IAAIC,KAAJ,CAAUR,KAAV,CAAjD,CAAb;AACA,WAAO,GAAGW,MAAH,CAAUT,WAAW,EAArB,EAAyBO,QAAQ,EAAjC,CAAP;AACD,GAND,CAME,OAAOG,GAAP,EAAY;AACZpC,UAAMoC,GAAN;AACA,WAAO,EAAP;AACD;AACF,CAZD;;AAcA,MAAMC,4BAA4B,MAAM;AACtC,SAAOhB,uBAAuB,0BAAvB,CAAP;AACD,CAFD;;AAIA,MAAMiB,2BAA2B,MAAM;AACrC,SAAOjB,uBAAuB,yBAAvB,CAAP;AACD,CAFD;;kBAIe;AACbH,aADa;AAEbN,iBAFa;AAGbO,wBAHa;AAIbC,yBAJa;AAKbiB,2BALa;AAMbC;AANa,C","file":"templates.js","sourcesContent":["import _ from 'lodash'\nimport fs from 'fs'\nimport path from 'path'\nimport logger from './debug'\n\nconst { debug } = logger('template')\n\nconst getTemplatePath = (templateName) => {\n  debug('getTemplatePath', templateName)\n  const options = { paths: [path.join(process.cwd(), 'node_modules')] }\n  return path.dirname(require.resolve(templateName, options))\n}\n\nconst getTemplateSpec = (templateName) => {\n  const templatePath = getTemplatePath(templateName)\n  debug('getTemplateSpec', templatePath)\n  return JSON.parse(\n    fs.readFileSync(path.join(templatePath, 'package.json'))\n  )\n}\n\nfunction getTemplate (templateName) {\n  debug('getTemplate', templateName)\n  const templatePath = getTemplatePath(templateName)\n  return path.join(templatePath, 'template')\n}\n\nconst builtInSocketTemplates = [\n  '@syncano/template-socket-vanilla',\n  '@syncano/template-socket-es6',\n  '@syncano/template-socket-es6-validate'\n]\n\nconst builtInProjectTemplates = [\n  '@syncano/template-project-empty',\n  '@syncano/template-project-hello'\n]\n\nconst findInstalledTemplates = (pattern) => {\n  debug('findInstalledTemplates', pattern)\n  try {\n    const configFile = JSON.parse(fs.readFileSync(path.join(process.cwd(), 'package.json')))\n    const regex = new RegExp(pattern)\n    const devDeps = _.findKey(configFile.devDependencies, (obj, key) => key.match(regex))\n    const deps = _.findKey(configFile.dependencies, (obj, key) => key.match(regex))\n    return [].concat(devDeps || [], deps || [])\n  } catch (err) {\n    debug(err)\n    return []\n  }\n}\n\nconst installedProjectTemplates = () => {\n  return findInstalledTemplates('syncano-template-project')\n}\n\nconst installedSocketTemplates = () => {\n  return findInstalledTemplates('syncano-template-socket')\n}\n\nexport default {\n  getTemplate,\n  getTemplateSpec,\n  builtInSocketTemplates,\n  builtInProjectTemplates,\n  installedProjectTemplates,\n  installedSocketTemplates\n}\n"]}